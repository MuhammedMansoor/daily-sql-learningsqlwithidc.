1. Find patients who are in services with above-average staff count.
2. List staff who work in services that had any week with patient satisfaction below 70.
3. Show patients from services where total admitted patients exceed 1000.

SOL
1, USE challenge;
SELECT p.patient_id as stff_cnt from patients p
left join staff s
using(service)
group by p.patient_id
having count(s.staff_id) >(
SELECT avg(staff_count) from (select  service,count(staff_id) as staff_count from staff
group by service) as avg_stff_count);

2, use challenge;
SELECT distinct(s.staff_id) from staff s
left join services_weekly sw
using (service)
where
s.service in
(SELECT service from services_weekly where patient_satisfaction<70);

3, USE Challenge;
select patient_id,service from patients
where service in (
select service
from services_weekly
group by service
having	sum(patients_admitted) >1000);


Challenge:
ind all patients who were admitted to services that had at least one week where patients were refused AND the average patient satisfaction for that service was below the overall hospital average satisfaction. 
Show patient_id, name, service, and their personal satisfaction score.


USE Challenge;
SELECT patient_id,name,service,satisfaction from patients p
where service in
(
SELECT service from services_weekly
where patients_refused>0
group by service
having avg(patient_satisfaction)<
(select avg(patient_satisfaction) from services_weekly)
);















