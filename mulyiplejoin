1. Join patients, staff, and staff_schedule to show patient service and staff availability.
2. Combine services_weekly with staff and staff_schedule for comprehensive service analysis.
3. Create a multi-table report showing patient admissions with staff information.



SOL
1, USE Challenge;
SELECT p.*,s.staff_id,ss.present from patients p
left join staff s using (service) left join staff_schedule ss using (staff_id);

2, USE Challenge;
SELECT sw.*,s.*,ss.* from services_weekly sw
left join staff s using(service) left join staff_schedule ss using(staff_id);

3, USE Challenge;
SELECT p.*,s.*,ss.* from patients p
left join staff s using(service) left join staff_schedule ss using(staff_id);

Create a comprehensive service analysis report for week 20 showing: service name, total patients admitted that week, total patients refused, average patient satisfaction, 
count of staff assigned to service, and count of staff present that week. Order by patients admitted descending.


USE Challenge;

SELECT 
    sw.service AS service_name,
    SUM(sw.patients_admitted) AS total_admitted,
    SUM(sw.patients_refused) AS total_refused,
    AVG(sw.patient_satisfaction) AS avg_satisfaction,
    COUNT(ss.staff_id) AS staff_assigned,
    SUM(ss.present) AS staff_present
FROM services_weekly sw
inner join staff s using(service)
left join staff_schedule ss using(staff_id)
WHERE sw.week = '20'
GROUP BY sw.service
ORDER BY total_admitted DESC;
