CASE
### Practice Questions:

1. Categorise patients as 'High', 'Medium', or 'Low' satisfaction based on their scores.
2. Label staff roles as 'Medical' or 'Support' based on role type.
3. Create age groups for patients (0-18, 19-40, 41-65, 65+).

Sol:
1, Use challenge;
SELECT Patient_id,
CASE 
WHEN Satisfaction>90 then "High"
WHEN Satisfaction>80 then "Medium"
WHEN Satisfaction>=70 then "Low"
ELSE "Need Improvement" 
END as Satisfaction
from patients;

2, Use challenge;
Select staff_name,
CASE
WHEN role in ("doctor","nurse") then "Medical"
Else "Support"
End as roles
from staff;

3, Use challenge;
SELECT patient_id,
CASE 
WHEN AGE>65 THEN "65+"
WHEN AGE between 41 AND 65 THEN "41-65"
WHEN AGE between 19 AND 40 THEN "19-40"
WHEN AGE between 0 AND 18 THEN "0-18"
ELSE " "
END AS Age_Group
from patients;

Question: Create a service performance report showing service name, total patients admitted, and a performance category based on the following: 
'Excellent' if avg satisfaction >= 85, 'Good' if >= 75, 'Fair' if >= 65, otherwise 'Needs Improvement'. Order by average satisfaction descending.

use challenge;
SELECT service,sum(patients_admitted) as Admitted_Patients,
CASE
WHEN AVG(PATIENT_SATISFACTION)>=85 THEN "Good"
WHEN AVG(PATIENT_SATISFACTION)>=75 THEN "Fair"
WHEN AVG(PATIENT_SATISFACTION)>=65 THEN "Needs Improvement"
ELSE " "
END AS Pefromance_Category
from services_weekly
Group By service
order by avg(PATIENT_SATISFACTION) desc;









  
